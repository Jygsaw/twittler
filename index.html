<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>
    <script>
      // render page
      function renderPage() {
        // clear page
        $body = $("body");
        $body.html("");

        // select tweets to display
        var user = undefined;
        var tweets = filterTweets(streams.home, user);

        // display tweets
        for (var i = 0; i < tweets.length; i++) {
          buildTweetElem(tweets[i]).appendTo($body);
        }
      }

      // select tweets to display based on given user
      function filterTweets(tweets, user) {
        var result = [];
        for (var i = tweets.length - 1; i >= 0; i--) {
          if (user === tweets[i].user || user === undefined) result.push(tweets[i]);
        }
        return result;
      }

      // builds DOM elements for given tweet
      function buildTweetElem(tweet) {
        var $tweet = $("<div></div>");
        var user = tweet.user;
        var message = tweet.message;
        var time = tweet.created_at;
        $tweet.text('@' + user + ': ' + message + " [" + time + "]");
        return $tweet;
      }

      // MAIN
      $(document).ready(function(){
        // display initial page
        renderPage();

        // initiate render loop
        window.setInterval(function() {
          renderPage();
        }, 1000);
      });
    </script>
  </body>
</html>
